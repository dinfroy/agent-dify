(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6787:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(5155),a=r(2596),o=r(2115),s=r(6671);function l(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-spin",children:[(0,n.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,n.jsx)("path",{d:"M12 3a9 9 0 1 0 9 9"})]})}function i(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,n.jsx)("path",{d:"M18 6v6a3 3 0 0 1 -3 3h-10l4 -4m0 8l-4 -4"})]})}var u=r(1500),d=r(3139);function c(){var e,t;let[r,c]=(0,o.useState)(""),p=(0,o.useRef)(null),f=function(){let[e,t]=(0,o.useState)(!1),r=(0,o.useRef)(null),n=(0,o.useRef)(null);function a(){var e;null==(e=r.current)||e.close(),r.current=null,t(!1)}return{isPlaying:e,play:async function(e,o){a(),r.current=new AudioContext({sampleRate:24e3});let s=r.current.currentTime,l=e.getReader(),i=new Uint8Array,u=await l.read();for(t(!0);!u.done&&r.current;){let e=new Uint8Array(i.length+u.value.length);e.set(i),e.set(u.value,i.length);let t=4*Math.floor(e.length/4),d=e.length%4,c=new Float32Array(e.buffer,0,t/4);i=new Uint8Array(e.buffer,t,d);let h=r.current.createBuffer(1,c.length,r.current.sampleRate);h.copyToChannel(c,0),n.current=r.current.createBufferSource(),n.current.buffer=h,n.current.connect(r.current.destination),n.current.start(s),s+=h.duration,(u=await l.read()).done&&(n.current.onended=()=>{a(),o()})}},stop:a}}(),x=(0,d.useMicVAD)({startOnLoad:!0,onSpeechEnd:e=>{f.stop();let t=new Blob([d.utils.encodeWAV(e)],{type:"audio/wav"});(0,o.startTransition)(()=>w(t)),navigator.userAgent.includes("Firefox")&&x.pause()},positiveSpeechThreshold:.6,minSpeechFrames:4});(0,o.useEffect)(()=>{function e(e){var t;return"Enter"===e.key?null==(t=p.current)?void 0:t.focus():"Escape"===e.key?c(""):void 0}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)});let[m,w,g]=(0,o.useActionState)(async(e,t)=>{let r=new FormData;for(let n of("string"==typeof t?(r.append("input",t),(0,u.u4)("Text input")):(r.append("input",t,"audio.wav"),(0,u.u4)("Speech input")),e))r.append("message",JSON.stringify(n));let n=Date.now(),a=await fetch("/api",{method:"POST",body:r}),o=decodeURIComponent(a.headers.get("X-Transcript")||""),l=decodeURIComponent(a.headers.get("X-Response")||"");if(!a.ok||!o||!l||!a.body)return 429===a.status?s.o.error("Too many requests. Please try again later."):s.o.error(await a.text()||"An error occurred."),e;let i=Date.now()-n;return f.play(a.body,()=>{navigator.userAgent.includes("Firefox")&&x.start()}),c(o),[...e,{role:"user",content:o},{role:"assistant",content:l,latency:i}]},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"pb-4 min-h-28"}),(0,n.jsxs)("form",{className:"rounded-full bg-neutral-200/80 dark:bg-neutral-800/80 flex items-center w-full max-w-3xl border border-transparent hover:border-neutral-300 focus-within:border-neutral-400 hover:focus-within:border-neutral-400 dark:hover:border-neutral-700 dark:focus-within:border-neutral-600 dark:hover:focus-within:border-neutral-600",onSubmit:function(e){e.preventDefault(),(0,o.startTransition)(()=>w(r))},children:[(0,n.jsx)("input",{type:"text",className:"bg-transparent focus:outline-hidden p-4 w-full placeholder:text-neutral-600 dark:placeholder:text-neutral-400",required:!0,placeholder:"Ask me anything",value:r,onChange:e=>c(e.target.value),ref:p}),(0,n.jsx)("button",{type:"submit",className:"p-4 text-neutral-700 hover:text-black dark:text-neutral-300 dark:hover:text-white",disabled:g,"aria-label":"Submit",children:g?(0,n.jsx)(l,{}):(0,n.jsx)(i,{})})]}),(0,n.jsxs)("div",{className:"text-neutral-400 dark:text-neutral-600 pt-4 text-center max-w-xl text-balance min-h-28 space-y-4",children:[m.length>0&&(0,n.jsxs)("p",{children:[null==(e=m.at(-1))?void 0:e.content,(0,n.jsxs)("span",{className:"text-xs font-mono text-neutral-300 dark:text-neutral-700",children:[" ","(",null==(t=m.at(-1))?void 0:t.latency,"ms)"]})]}),0===m.length&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["A fast, open-source voice assistant powered by"," ",(0,n.jsx)(h,{href:"https://groq.com",children:"Groq"}),","," ",(0,n.jsx)(h,{href:"https://cartesia.ai",children:"Cartesia"}),","," ",(0,n.jsx)(h,{href:"https://www.vad.ricky0123.com/",children:"VAD"}),", and"," ",(0,n.jsx)(h,{href:"https://vercel.com",children:"Vercel"}),"."," ",(0,n.jsx)(h,{href:"https://github.com/ai-ng/swift",target:"_blank",children:"Learn more"}),"."]}),x.loading?(0,n.jsx)("p",{children:"Loading speech detection..."}):x.errored?(0,n.jsx)("p",{children:"Failed to load speech detection."}):(0,n.jsx)("p",{children:"Start talking to chat."})]})]}),(0,n.jsx)("div",{className:(0,a.A)("absolute size-36 blur-3xl rounded-full bg-linear-to-b from-red-200 to-red-400 dark:from-red-600 dark:to-red-800 -z-50 transition ease-in-out",{"opacity-0":x.loading||x.errored,"opacity-30":!x.loading&&!x.errored&&!x.userSpeaking,"opacity-100 scale-110":x.userSpeaking})})]})}function h(e){return(0,n.jsx)("a",{...e,className:"text-neutral-500 dark:text-neutral-500 hover:underline font-medium"})}},7545:(e,t,r)=>{Promise.resolve().then(r.bind(r,6787))}},e=>{var t=t=>e(e.s=t);e.O(0,[35,671,806,441,684,358],()=>t(7545)),_N_E=e.O()}]);